import os.path
import sys
import pefile
import magic
import re

def getMimeType(file):
    mime = magic.Magic(mime=True)
    mimeType = mime.from_file(file)
    return mimeType


def fileAnalysis(mimeType, fileName):
    #Do Analysis
    #Get Verdict
    #return verdict and artifact array
    return

def determineVerdict(analysisFile, artifacts):
    #API check with Virustotal
    #Examine artifacts
    #return verdict
    return

def main():
    #check mime-type of file
    #Automatic analysis or user input to force analysis type?
    #case statement for specific mime-type
        #image file
        #word doc
        #excel doc
        #pdf file
        #exe file
        #dll file
        #etc...
    doc = ["application/msword", "application/vnd.ms-word.document.macroEnabled.12", "application/vnd.ms-word.template.macroEnabled.12"]
    xls = ["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-excel", "application/vnd.ms-excel.sheet.macroEnabled.12", "application/vnd.ms-excel.template.macroEnabled.12", "application/vnd.ms-excel.addin.macroEnabled.12", "application/vnd.ms-excel.sheet.binary.macroEnabled.12"]
    ppt = ["application/vnd.ms-powerpoint", "application/vnd.ms-powerpoint.presentation.macroEnabled.12", "application/vnd.ms-powerpoint.template.macroEnabled.12", "application/vnd.ms-powerpoint.addin.macroEnabled.12", "application/vnd.ms-powerpoint.slideshow.macroEnabled.12"]
    pdf = ["application/pdf"]
    exe = ["application/vnd.microsoft.portable-executable", "application/octet-stream", "application/x-dosexec"]


    file = sys.argv[1]
    mimeType = getMimeType(file)
    #print "Your Mime type is " + mimeType


    if mimeType in doc:
        print "This is a MSWord Document"
    elif mimeType in xls:
        print "This is a MSExcel Document"
    elif mimeType in ppt:
        print "This is a MSPowerpoint Document"
    elif mimeType in pdf:
        print "This is a PDF file"
    elif mimeType in exe:
        print "This is a EXE file"
    elif re.match(r"^image\/\w*$", mimeType):
        print "This is a image file"
    else:
        print "This file is not supported at this time"

    print mimeType

main()
